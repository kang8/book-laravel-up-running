
## 路由定义

* routes/web.php 中定义 Web 路由。Web 路由是用来提供给终端（浏览器、手机）用户进行访问的。
* routes/api.php 中定义 API 路由。API 路由主要是用来提供 API 服务的。

### 路由动词
```php
Route::get('/', function() {
    return 'Hello, World!';
});

Route::post('/', function() {
    // deal with Accept POST request
});

Route::put('/', function() {
    // deal with Accept PUT request
});

Route::delete('/', function() {
    // deal with Accept DELETE request
});

Route::any('/', function() {
    // deal with any HTTP request
});

Route::match(['get', 'post'], '/', function() {
    // deal with Accept GET and POST request
});
```

### 路由调用控制器方法 - controller
```php
Route::get('/', 'WelcomeController@index');

Route::get('/', [WelcomeController::class, 'index']);
```

### 路由参数 - parameter
```php
Route::get('users/{id}/friends', function($id){ // same to function($user_id)
    //
});

// 可选路由参数
Route::get('users/{id?}', function($id = 'fallbackId'){
    //
});

// 针对路由参数，可以使用正则表达式去匹配特定路由
Route::get('users/{id}', function($id){
    //
})->where('id', '[0-9]+');

Route::get('users/{username}', function($username){
    //
})->where('username', '[A-Za-z]+');

Route::get('posts/{id}/{slug}', function($id, $slug){
    //
})->where([ 'id' => '[0-9]+', 'slug' => '[A-Za-z]+' ]);

> 对于上诉正则表达式匹配。由于路由是从上到下匹配的。
> `users/abc` 将跳过第一个路由，它将于第二个路由匹配上。
```

### 路由名称 - name
```php
Route::get('members/{id}', 'MembersController@show')->name('members.show');
```

路由命名格式：resourcePlural.action。以 photo 为例：
* photos.index
* photos.create
* photos.store
* photos.show
* photos.edit
* photos.update
* photos.destory

### 路由组 - group

What：认证、权限控制、路径前缀、控制器命名空间等。

```php
// base
Route::group(function() {
    Route::get('hello', function() {
        return 'Hello';
    })
    Route::get('world', function() {
        return 'World';
    })
});

// 中间键 - middleware
// 用户必须登录(auth)才能查看控制中心(dashboard)和账户页面(account)
Route::middleware('auth')->group(function() {
    Route::get('dashboard', function() {
        return view('dashboard')
    })
    Route::get('account', function() {
        return view('account')
    })
})

// 路径前缀 - prefix
Route::prefix('dashboard')->group(function() {
    Route::get('/', function() {
        // path: /dashboard
    })
    Route::get('users', function() {
        // path: /dashboard/users
    })
})

// 子域名路由 - domain
Route::domain('api.myapp.com')->group(function() {
    Route::get('/', function() {
        //
    })
})
// or 参数化的子域名路由，可以实现多租户。
Route::domain('{account}.myapp.com')->group(function() {
    Route::get('/', function($account) {
        //
    })
    Route::get('users/{id}', function($account, $id) {
        //
    })
})

// 路由命名空间前缀 - namespace
// App\Http\Controller\UserController
Route::get('/', 'UserController@index');

Route::namespace('Dashboard')->group(function() {
    // App\Http\Controller\Dashboard\PurchasesController
    Route::get('dashboard/purchases', 'PurchasesController@index')
})
```

### 签名的路由

MUST：必须要有路由名称。

例如：
```php
Route::get('invitations/{invitation}/{answer}', 'InvitationController@index')->name('invitations');
```

生成签名：
```php
URL::route('invitations', ['invitation' => 12345, 'answer' => 'yes']);

URL::signedRoute('invitations', ['invitation' => 12345, 'answer' => 'yes']);

URL::tempporarySignRoute(
    'invitations', 
    now()->addHours(4),
    ['invitation' => 12345, 'answer' => 'yes']);
```

### Other

* 后备路由：处理所有没有匹配上的路径。
    ```php
    Route::fallback(function() {  };)
    ```

## 全局函数

* url() - 获取站点全路径
    ```php
    echo url('/') // {APP_URL}/
    ```

* route() - 使用命名路由来展示站点全路径
    ```php
    Route::get('users/{userId}/comments/{commentId}', 'CommentController@show')->name('users.comments.show');

    route('users.comments.show', [1, 2]); // {APP_URL}/users/1/coments/2

    route('users.comments.show', ['userId' => 1, 'commentId' => 2]); // {APP_URL}/users/1/comments/2

    route('users.comments.show', ['commentId' => 2, 'userId' => 1]); // {APP_URL}/users/1/comments/2

    route('users.comments.show', ['userId' => 1, 'commentId' => 2, 'opt' => 'a'); // {APP_URL}/users/1/comments/2?opt=a
    ```

* now() - Carbon::now()，返回今天的 Carbon 对象
